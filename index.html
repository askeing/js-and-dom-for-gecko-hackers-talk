<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=1024, user-scalable=no">

  <title>JS and DOM for Gecko Hackers</title>

  <!-- Required stylesheet -->
  <link rel="stylesheet" href="core/deck.core.css">

  <!-- Extension CSS files go here. Remove or add as needed. -->
  <link rel="stylesheet" media="screen" href="extensions/goto/deck.goto.css">
  <link rel="stylesheet" media="screen" href="extensions/menu/deck.menu.css">
  <link rel="stylesheet" media="screen" href="extensions/navigation/deck.navigation.css">
  <link rel="stylesheet" media="screen" href="extensions/status/deck.status.css">
  <link rel="stylesheet" media="screen" href="extensions/scale/deck.scale.css">
  <link rel="stylesheet" media="screen" href="extensions/codemirror/themes/codemirror.css">
  <link rel="stylesheet" media="screen" href="extensions/codemirror/deck.codemirror.css">

  <!-- Style theme. More available in /themes/style/ or create your own. -->
  <link rel="stylesheet" media="screen" href="themes/style/mozilla-sandstone-nightly.css">
  <link rel="stylesheet" media="screen" href="themes/style/custom.css">
  <link rel="stylesheet" media="screen" href="extensions/codemirror/themes/cobalt.css">

  <!-- Transition theme. More available in /themes/transition/ or create your own. -->
  <link rel="stylesheet" media="screen" href="themes/transition/horizontal-slide.css">

  <!-- Basic black and white print styles -->
  <link rel="stylesheet" media="print" href="core/print.css">

  <!-- Required Modernizr file -->
  <script type="application/javascript;version=1.7" src="modernizr.custom.js"></script>
</head>
<body>

  <div class="deck-container">
    <!-- Begin slides. Just make elements with a class of slide. -->

    <section class="slide">
      <h1>JS and DOM for Gecko Hackers</h1>
      <footer><a href="http://mzl.la/1Fwu9yU"><img style="width:100px;height:100px" src="qr_code.png"> (http://mzl.la/1Fwu9yU)</a></footer>
    </section>

    <section class="slide">
      <h1>Quick introduction and disclaimer</h1>
    </section>

    <section class="slide">
      <h1>I assume webdev familiarity of JS and the DOM</h1>
    </section>

    <section class="slide">
      <h2>Today's objectives</h2>
        <ul>
          <li class="slide">Write code which uses prototype-based inheritance</li>
          <li class="slide">Understand and use <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/let" target="_blank"><code>let</code></a> and <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/for...of" target="_blank"><code>for...of</code></a></li>
          <li class="slide"><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Destructuring_assignment" target="_blank">Array and object destructuring</a></li>
          <li class="slide"><a href="https://developer.mozilla.org/en-US/docs/Web/API/Worker" target="_blank">Workers</a></li>
          <li class="slide"><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise" target="_blank">Promises</a> and <a href="https://developer.mozilla.org/en-US/docs/Mozilla/JavaScript_code_modules/Task.jsm" target="_blank">Task.jsm</a></li>
          <li class="slide"><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions/Arrow_functions" target="_blank">Arrow functions</a></li>
          <li class="slide"><a href="https://developer.mozilla.org/en-US/docs/Tools/Browser_Toolbox" target="_blank">The Browser Toolbox</a></li>
          <li class="slide">Profiling</li>
          <li class="slide">Writing restartless extensions with the <a href="https://developer.mozilla.org/en-US/Add-ons/SDK">SDK</a></li>
          <li class="slide">Using page-mods to alter a site in an extension</li>
          <li class="slide">Debugging an extension</li>
          <li class="slide">Testing Gecko</li>
          <li class="slide">Writing a "browser chrome" mochitest</li>
        </ul>
    </section>

    <section class="slide">
      <h1>Ask questions!</h1>
    </section>

    <!-- SECTION: OOP / Prototype inheritance -->

    <section class="slide">
      <h2>Prototype-based inheritance...</h2>
      <ul>
        <li class="slide">Usually abstracted away by libraries like Underscore.js or lodash</li>
        <li class="slide">Typical approach for defining a "class":
          <textarea class="code" mode="javascript" style="display: none;" theme="cobalt" runnable="true">
function Animal(sound) {
  this.sound = sound;
}

Animal.prototype = {
  speak() { // ES6 style
    console.log(this.sound);
  }
};

let a = new Animal('quack');
a.speak();
</textarea>
        </li>
    </section>

    <section class="slide">
      <h2>Prototype-based inheritance...</h2>
      <ul>
        <li class="slide">Now let's extend this class a bit.
          <textarea class="code" mode="javascript" style="display: none;" theme="cobalt" runnable="true">
function Animal(sound) {
  this.sound = sound;
}

Animal.prototype = {
  speak() { // ES6 style
    console.log(this.sound);
  }
};

function Duck(name) {
  Animal.call(this, "quack");
  this.name = name;
}

Duck.prototype = Object.create(Animal.prototype);
Duck.prototype.greet = function(who) {
  console.log(`Hello ${who}, I'm a duck and my name is ${this.name}. ${this.sound}!`);
  // I'm using a ES6 template string here --^
}

let d = new Duck("Howard");
d.speak();
//d.greet("Mike");
// Now let's do stuff with getters (get foo(), and Object.create)
// Also, instanceof - though instanceof can be easily fooled
</textarea>
        </li>
        <li class="slide"><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Inheritance_and_the_prototype_chain" target="_blank">On inheritance in Javascript.</a></li>
        <li class="slide"><a href="https://medium.com/javascript-scene/common-misconceptions-about-inheritance-in-javascript-d5d9bab29b0a" target="_blank">JS OOP gotchas, and an argument against inheritance.</a></li>
    </section>

    <!-- SECTION: let -->
    <section class="slide">
      <h2>let</h2>
      <ul>
        <li class="slide"><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/let" target="_blank">Here's a link to some more comprehensive documentation</a></li>
        <li class="slide">In the beginning, there was <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/var" target="_blank"><code>var</code></a>. And it was alright... but there are some interesting gotchas.</li>
        <li class="slide"><code>var</code> is function scoped, whereas <code>let</code> is block scoped.
          <textarea class="code" mode="javascript" style="display: none;" theme="cobalt" runnable="true">
(function scope() {
  var baz = "Plz don't overwrite me."
  { // <-- this could be a block for a conditional, a loop, etc...
    var baz = "blam!";
    console.log(baz);
  }

  console.log(baz);
}());

// This has interesting consequences for for-loop binding
// doing async things - example:
/*
for (var i = 0; i < 3; ++i) {
  setTimeout(function() {
    console.log(i);
  }, 50);
}*/
</textarea>
        </li>
        <li class="slide">Other gotchas...
          <textarea class="code" mode="javascript" style="display: none;" theme="cobalt" runnable="true">
// var's can be redeclared in the same block scope, whereas let's cannot.
{
  var x = 1;
  var x = 2;
}

// var hoists! let does not.
/*
(function() {
  console.log(foo);
  var foo = "The above will result in undefined, not a ReferenceError";
}());
*/
</textarea>
        </li>
    </section>

    <section class="slide">
      <h2>let</h2>
        <li class="slide">IMO, <code>let</code> performs like you'd expect, and sidesteps <code>var</code>'s footguns.</li>
        <li class="slide">You might see <code>var</code>'s being used in new code being defined in the global scope.</li>
        <li class="slide">Some scripts will have <code>var</code>'s exclusively. This is usually an age hint.</li>
    </section>

    <!-- SECTION: for...of -->
    <section class="slide">
      <h2>for...of</h2>
      <ul>
        <li class="slide"><code>for</code>, <code>for...in</code>, <code>forEach</code>, <code>for each...in</code> (deprecated)</li>
        <li class="slide"><code>for...of</code></h2> is great for <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Iteration_protocols" target="_blank">iterable objects</a> like <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array?redirectlocale=en-US&redirectslug=JavaScript%2FReference%2FGlobal_Objects%2FArray" target="_blank"><code>Arrays</code></a>, <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Map" target="_blank"><code>Maps</code></a>, <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Map" target="_blank"><code>Sets</code></a>, and <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Iteration_protocols#User-defined_iterables" target="_blank">anything exposing <code>Symbol.iterator</code> as a property</a></li>
        <li class="slide">Object property iteration still done with <code>for...in</code></li>
        <li class="slide">Example:
          <textarea class="code" mode="javascript" style="display: none;" theme="cobalt" runnable="true">
//let x = [1, 2, 3];

/*
let x = new Set();
x.add('foo');
x.add('bar');*/

//let x = {test: 'hello', test2: 'hello again'}; // Won't work

// Maps with decomposition: for (let [key, value] of someMap)...

for (let thing of x) {
  console.log(thing);
}
</textarea>
        </li>
        <li class="slide">Generally speaking, <code>for...of</code> is probably the way you want to iterate, except for <code>Object</code> properties</li>
      </ul>
    </section>

    <!-- SECTION: Destructuring -->
    <section class="slide">
      <h2><code>Object</code> and <code>Array</code> destructuring</h2>
      <ul>
        <li class="slide">Fancy shorthand for multi-variable assignment</li>
        <li class="slide">Useful if you have a function that returns an <code>Object</code> or an <code>Array</code> that you only want a part of.</li>
        <li class="slide">Example:
          <textarea class="code" mode="javascript" style="display: none;" theme="cobalt" runnable="true">
function mikesPage() {
  return {
    url: 'http://www.mikeconley.ca',
    type: 'blog'
  };
}

let { url } = mikesPage();
console.log(url);
let { url: someURL } = mikesPage();
console.log(someURL);
// Gotcha: I can do let reassignment in block scope with destructuring. Fun times!

// Arrays...
</textarea>
    </section>

    <section class="slide">
      <h2><code>Object</code> and <code>Array</code> destructuring</h2>
      <ul>
        <li class="slide">Also useful when a function accepts an <code>Object</code>
        <textarea class="code" mode="javascript" style="display: none;" theme="cobalt" runnable="true">

function myFunction({ firstArg, secondArg }) {
  console.log(`First arg: ${firstArg}, secondArg: ${secondArg}`);
}

myFunction({
  firstArg: "This is first!",
  secondArg: "This is second!",
});
</textarea></li>
        <li class="slide">Common pattern:
          <pre>
            const { classes: Cc, interfaces: Ci, utils: Cu } = Components;
            // ^-- oh yeah, const...
          </pre></li>

        <li class="slide"><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Destructuring_assignment" target="_blank">Lots of other examples right here</a></li>
        <li class="slide"><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/const" target="_blank">Documentation on <code>const</code></a>
    </section>

    <!-- QUESTIONS -->

    <section class="slide">
      <h2>Whew!</h2>
      <ul>
        <li class="slide">Hopefully we're about 1 hour in, or thereabouts.</li>
        <li class="slide">Let's hear some questions.
      <textarea class="code" mode="javascript" style="display: none;" theme="cobalt" runnable="true">
</textarea></li>
    </section>




    <!-- End slides. -->

    <!-- Begin extension snippets. Add or remove as needed. -->

    <!-- deck.status snippet -->
    <p class="deck-status" aria-role="status">
      <span class="deck-status-current"></span>
      /
      <span class="deck-status-total"></span>
    </p>

    <!-- deck.goto snippet -->
    <form action="." method="get" class="goto-form">
      <label for="goto-slide">Go to slide:</label>
      <input type="text" name="slidenum" id="goto-slide" list="goto-datalist">
      <datalist id="goto-datalist"></datalist>
      <input type="submit" value="Go">
    </form>

    <!-- End extension snippets. -->
  </div>

<!-- Required JS files. -->
<script type="application/javascript;version=1.8" src="jquery.min.js"></script>
<script type="application/javascript;version=1.8" src="core/deck.core.js"></script>

<!-- Extension JS files. Add or remove as needed. -->
<script type="application/javascript;version=1.8" src="extensions/menu/deck.menu.js"></script>
<script type="application/javascript;version=1.8" src="extensions/goto/deck.goto.js"></script>
<script type="application/javascript;version=1.8" src="extensions/status/deck.status.js"></script>
<script type="application/javascript;version=1.8" src="extensions/navigation/deck.navigation.js"></script>
<script type="application/javascript;version=1.8" src="extensions/scale/deck.scale.js"></script>
<script type="application/javascript;version=1.8" src="extensions/navigation/jquery.hotkeys.js"></script>

<!-- Base codemiror code -->
<script type="application/javascript;version=1.8" src="extensions/codemirror/codemirror.js"></script>

<!-- Syntax highlighting Modes -->

<!-- javascript -->
<script type="application/javascript;version=1.8" src="extensions/codemirror/mode/javascript/javascript.js"></script>

<!-- html mode (note html mode requires xml, css and javascript) -->
<script type="application/javascript;version=1.8" src="extensions/codemirror/mode/xml/xml.js"></script>
<script type="application/javascript;version=1.8" src="extensions/codemirror/mode/css/css.js"></script>
<script type="application/javascript;version=1.8" src="extensions/codemirror/mode/htmlmixed/htmlmixed.js"></script>

<!-- Plugin code -->
<script type="application/javascript;version=1.8" src="extensions/codemirror/deck.codemirror.js"></script>

<!-- Initialize the deck. You can put this in an external file if desired. -->
<script type="application/javascript;version=1.8">
  $(function() {
    $(document).bind("keydown", "ctrl+f", function() {
      if (!document.mozFullScreenElement) {
        document.documentElement.mozRequestFullScreen();
      } else {
        document.mozCancelFullScreen();
      }
    });
    $(document).bind("keydown", "ctrl+g", function() {
      setTimeout(function() {
        $.deck('showGoTo');
      }, 100);
    });
    $.deck('.slide');
  });

</script>
</body>
</html>
